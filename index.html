<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AmitXBhai Tool</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: sans-serif;
      background: #111;
      color: #fff;
      margin: 0;
      padding: 20px;
    }
    .box {
      background: #222;
      padding: 20px;
      border-radius: 12px;
      max-width: 600px;
      margin: auto;
    }
    textarea, input {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 10px;
      border: none;
      font-family: monospace;
      background: #333;
      color: #fff;
    }
    button {
      padding: 10px 20px;
      border-radius: 8px;
      background: #00c853;
      color: #fff;
      border: none;
      margin: 6px 4px 6px 0;
      cursor: pointer;
    }
    .output {
      white-space: pre-wrap;
      background: #000;
      padding: 15px;
      margin-top: 10px;
      border-radius: 8px;
    }
    .copy-btn {
      margin-top: 10px;
      background: #1565c0;
    }
    .toast {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: #00c853;
      color: #fff;
      padding: 10px 18px;
      border-radius: 8px;
      display: none;
      animation: fade 2s forwards;
      font-weight: bold;
    }
    @keyframes fade {
      0% { opacity: 0; bottom: 10px; }
      10% { opacity: 1; bottom: 20px; }
      90% { opacity: 1; bottom: 20px; }
      100% { opacity: 0; bottom: 30px; }
    }
  </style>
</head>
<body>
  <div class="box">
    <h2>AmitXBhai Code Tool</h2>

    <label>Insert Code (e.g., ABCD1234 2300):</label>
    <input type="text" id="codeInput">
    <button onclick="insertCode()">‚ûï Insert</button>

    <label>Date:</label>
    <input type="text" id="dateInput" placeholder="e.g., 15 June">

    <label>List (e.g., 1. 2400 5):</label>
    <textarea id="listInput" rows="6" placeholder="Enter list..."></textarea>

    <button onclick="saveList()">üíæ Save List</button>
    <button onclick="showList()">üëÄ Show</button>

    <div id="result" class="output"></div>
    <button id="copyBtn" class="copy-btn" style="display:none;" onclick="copyResult()">üìã Copy</button>
  </div>

  <div class="toast" id="toast"></div>

  <script>
    let userData = {
      date: '',
      list: [],
      nextIndex: 0
    };

    function showToast(msg, color = "#00c853") {
      const toast = document.getElementById("toast");
      toast.innerText = msg;
      toast.style.background = color;
      toast.style.display = "block";
      setTimeout(() => {
        toast.style.display = "none";
      }, 2000);
    }

    function saveList() {
      const date = document.getElementById("dateInput").value.trim();
      const lines = document.getElementById("listInput").value.trim().split("\n");

      let cleaned = [];
      for (let line of lines) {
        line = line.trim();
        if (!line) continue;
        let parts = line.split(/\s+/);
        let serial = parseInt(parts[0]);
        if (!isNaN(serial)) {
          if (line.toLowerCase().includes("del")) {
            cleaned.push({ serial, value: "deleted" });
          } else {
            cleaned.push({ serial, value: parts[parts.length - 1] });
          }
        }
      }

      userData = {
        date,
        list: cleaned,
        nextIndex: 0
      };

      localStorage.setItem("amit_user_data", JSON.stringify(userData));
      showToast("‚úÖ List saved!");
    }

    function insertCode() {
      const val = document.getElementById("codeInput").value.trim();
      const [code, number] = val.split(/\s+/);
      if (!code || !number || (code.length !== 8 && code.length !== 9) || isNaN(number)) {
        showToast("‚ùå Format: ABC123456 2300", "#ff1744");
        return;
      }

      for (let i = userData.nextIndex; i < userData.list.length; i++) {
        let item = userData.list[i];
        if (item.value !== "deleted" && !item.value.includes(" ")) {
          item.value = `${code}   ${number}   ${item.value}`;
          userData.nextIndex = i + 1;
          localStorage.setItem("amit_user_data", JSON.stringify(userData));
          showToast(`‚úÖ Inserted at serial ${item.serial}`);
          return;
        }
      }
      showToast("‚ö†Ô∏è No space left to insert.", "#ff9100");
    }

    function showList() {
      const saved = localStorage.getItem("amit_user_data");
      const resultEl = document.getElementById("result");
      const copyBtn = document.getElementById("copyBtn");

      if (!saved) {
        resultEl.innerText = "No data.";
        copyBtn.style.display = "none";
        return;
      }
      const data = JSON.parse(saved);
      let output = `**${data.date}**\n\n****\n\n`;
      for (let item of data.list) {
        let val = item.value.replace(/\b([A-Za-z0-9]{8,9})\b/g, "`$1`");
        output += `${item.serial}.   ${val}\n\n`;
      }
      resultEl.innerText = output;
      copyBtn.style.display = "inline-block";
    }

    function copyResult() {
      const text = document.getElementById("result").innerText;
      navigator.clipboard.writeText(text).then(() => {
        showToast("üìã Copied!");
      });
    }

    window.onload = () => {
      const saved = localStorage.getItem("amit_user_data");
      if (saved) userData = JSON.parse(saved);
    };
  </script>
</body>
</html>
