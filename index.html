<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AmitXBhai's Tool</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: sans-serif;
      background: #111;
      color: #fff;
      margin: 0;
      padding: 20px;
    }
    .box {
      background: #222;
      padding: 20px;
      border-radius: 12px;
      max-width: 600px;
      margin: auto;
    }
    textarea, input {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 10px;
      border: none;
      font-family: monospace;
      background: #333;
      color: #fff;
    }
    button {
      padding: 10px 20px;
      border-radius: 8px;
      background: #00c853;
      color: #fff;
      border: none;
      margin-right: 10px;
    }
    .output {
      white-space: pre-wrap;
      background: #000;
      padding: 15px;
      margin-top: 10px;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <div class="box">
    <h2>AmitXBhai Code Tool</h2>

    <label>Date:</label>
    <input type="text" id="dateInput" placeholder="e.g., 15 June">

    <label>List (e.g., 1. 2400 5):</label>
    <textarea id="listInput" rows="6" placeholder="Enter list..."></textarea>

    <button onclick="saveList()">üíæ Save List</button>

    <label>Insert Code (e.g., ABCD12345 2300):</label>
    <input type="text" id="codeInput">

    <button onclick="insertCode()">‚ûï Insert</button>
    <button onclick="showList()">üëÄ Show</button>

    <div id="result" class="output"></div>
  </div>

  <script>
    let userData = {
      date: '',
      list: [],
      nextIndex: 0
    };

    function saveList() {
      const date = document.getElementById("dateInput").value.trim();
      const lines = document.getElementById("listInput").value.trim().split("\n");

      let cleaned = [];
      for (let line of lines) {
        line = line.trim();
        if (!line) continue;
        let parts = line.split(/\s+/);
        let serial = parseInt(parts[0]);
        if (!isNaN(serial)) {
          if (line.toLowerCase().includes("del")) {
            cleaned.push({ serial, value: "deleted" });
          } else {
            cleaned.push({ serial, value: parts[parts.length - 1] });
          }
        }
      }

      userData = {
        date,
        list: cleaned,
        nextIndex: 0
      };

      localStorage.setItem("amit_user_data", JSON.stringify(userData));
      alert("‚úÖ List saved.");
    }

    function insertCode() {
      const val = document.getElementById("codeInput").value.trim();
      const [code, number] = val.split(/\s+/);
      if (!code || !number || code.length !== 9 || isNaN(number)) {
        alert("‚ùå Format should be like: ABC123456 2300");
        return;
      }

      for (let i = userData.nextIndex; i < userData.list.length; i++) {
        let item = userData.list[i];
        if (item.value !== "deleted" && !item.value.includes(" ")) {
          item.value = `${code}   ${number}   ${item.value}`;
          userData.nextIndex = i + 1;
          localStorage.setItem("amit_user_data", JSON.stringify(userData));
          alert(`‚úÖ Inserted at serial ${item.serial}`);
          return;
        }
      }
      alert("‚ö†Ô∏è No space left to insert.");
    }

    function showList() {
      const saved = localStorage.getItem("amit_user_data");
      if (!saved) {
        document.getElementById("result").innerText = "No data.";
        return;
      }
      const data = JSON.parse(saved);
      let output = `**${data.date}**\n\n****\n\n`;
      for (let item of data.list) {
        let val = item.value.replace(/\b([A-Za-z0-9]{9})\b/g, "`$1`");
        output += `${item.serial}.   ${val}\n\n`;
      }
      document.getElementById("result").innerText = output;
    }

    // Auto-load on page open
    window.onload = () => {
      const saved = localStorage.getItem("amit_user_data");
      if (saved) userData = JSON.parse(saved);
    };
  </script>
</body>
</html>
